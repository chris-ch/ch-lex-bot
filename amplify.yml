version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm install -g pnpm ts-node
        - pnpm install
        - ts-node generate-csp.ts
    build:
      commands:
        - pnpm build
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  customHeaders: ${file(./amplify-headers.json)}
